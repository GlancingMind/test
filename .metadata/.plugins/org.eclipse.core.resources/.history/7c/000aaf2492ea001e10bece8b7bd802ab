grammar org.xtext.example.mydsl.MyDsl with org.eclipse.xtext.common.Terminals

generate myDsl "http://www.xtext.org/example/mydsl/MyDsl"

Model:
	(nodes+=NodeDefinition
	| systems+=SystemDefinition
	| deployments+=Deployment
	| platforms+=PlatformDefinition)*;



NodeDefinition: 'node' name=ID ';';
NodeInstance: type=[NodeDefinition] name=ID;

SystemDefinition:
	'system' name=ID '{'(
			'nodes' ':' (nodes+=NodeInstance ';')*
		| 'subsystems' ':' (subsystems+=SystemInstance ';')*
		)*
	'}'
;

SystemInstance: type=[SystemDefinition] name=ID;

SystemReference: (belongingSystem=SystemReference '.')? system=[SystemInstance];

NodeInstanceReference: belongingSystem=SystemInstance '.' node=[NodeInstance];

PlatformDefinition:	'plat' name=ID ';';

Deployment: 'deploy' (nodes+=NodeInstanceReference ',')+ '->' platform=[PlatformDefinition] ';';