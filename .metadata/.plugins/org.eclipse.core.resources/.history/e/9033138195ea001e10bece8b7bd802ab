grammar org.xtext.example.mydsl.MyDsl with org.eclipse.xtext.common.Terminals

generate myDsl "http://www.xtext.org/example/mydsl/MyDsl"

Model:
	(nodes+=NodeDefinition
	| systems+=SystemDefinition
	| deployments+=Deployment)*;



NodeDefinition: 'node' name=ID ';';
NodeInstance: type=[NodeDefinition] name=ID;

SystemDefinition:
	'system' name=ID '{'(
			'nodes' ':' (nodes+=NodeInstance ';')*
		| 'subsystems' ':' (subsystems+=SystemInstance ';')*
		)*
	'}'
;

SystemInstance: type=[SystemDefinition] name=ID;

SystemReference: (belongingSystem=[SystemReference] '.')? system=[SystemInstance];

RootSystem: 'root' 'system' 'instance' SystemInstance ';';

NodeInstanceReference: belongingSystem=[SystemReference] '.' node=[NodeInstance];

PlatformInstance: name=ID;

DeploymentStatement:
	'deploys' nodes=NodeInstanceReference 'on' platform=[PlatformInstance] ';'
;

Deployment: {Deployment} 'deployment' '{'
		('platform' platforms+=PlatformInstance ';')*
		('system' systems+=SystemInstance ';')*
		(deployments+=DeploymentStatement)*
	'}'
;



